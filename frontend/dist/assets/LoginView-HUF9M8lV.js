/* empty css                *//* empty css                 */import{d as q,u as N,r as m,a as V,c as S,b as a,w as o,E as F,e as I,o as _,f as R,g as b,h as x,i as A,j as M,k as j,l as p,t as v,m as T,n as h,p as y}from"./index-mlxIPnk9.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"login-container"},G={class:"card-header"},H=q({__name:"LoginView",setup(J){const c=I(),i=N(),s=m(!0),f=m(!1),g=m(!1),d=m(),e=V({username:"",email:"",password:"",confirmPassword:""}),E=V({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(r,l,t)=>{l!==e.password?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}]}),L=()=>{s.value=!s.value,k()},k=()=>{var r;e.username="",e.email="",e.password="",e.confirmPassword="",(r=d.value)==null||r.clearValidate()},C=async()=>{if(d.value)try{if(!await d.value.validate())return;f.value=!0,s.value?(await i.login({username:e.username,password:e.password}),y.success("登录成功"),i.isAdmin()?c.push("/admin"):c.push("/chat")):(await i.register({username:e.username,email:e.email,password:e.password}),y.success("注册成功"),c.push("/chat"))}catch(r){console.error("提交失败:",r)}finally{f.value=!1}},P=async()=>{try{g.value=!0;const r=await i.loginWithLinuxDo();window.location.href=r}catch(r){console.error("Linux.Do 登录失败:",r),y.error("无法启动 Linux.Do 登录")}finally{g.value=!1}};return(r,l)=>{const t=M,n=A,w=j,D=T,B=R,U=F;return _(),S("div",z,[a(U,{class:"login-card"},{header:o(()=>[h("div",G,[h("h1",null,v(s.value?"登录":"注册"),1)])]),default:o(()=>[a(B,{model:e,rules:E,ref_key:"formRef",ref:d,"label-width":"80px"},{default:o(()=>[a(n,{label:"用户名",prop:"username"},{default:o(()=>[a(t,{modelValue:e.username,"onUpdate:modelValue":l[0]||(l[0]=u=>e.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s.value?x("",!0):(_(),b(n,{key:0,label:"邮箱",prop:"email"},{default:o(()=>[a(t,{modelValue:e.email,"onUpdate:modelValue":l[1]||(l[1]=u=>e.email=u),placeholder:"请输入邮箱",type:"email"},null,8,["modelValue"])]),_:1})),a(n,{label:"密码",prop:"password"},{default:o(()=>[a(t,{modelValue:e.password,"onUpdate:modelValue":l[2]||(l[2]=u=>e.password=u),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),s.value?x("",!0):(_(),b(n,{key:1,label:"确认密码",prop:"confirmPassword"},{default:o(()=>[a(t,{modelValue:e.confirmPassword,"onUpdate:modelValue":l[3]||(l[3]=u=>e.confirmPassword=u),type:"password",placeholder:"请确认密码","show-password":""},null,8,["modelValue"])]),_:1})),a(n,null,{default:o(()=>[a(w,{type:"primary",onClick:C,loading:f.value,style:{width:"100%"}},{default:o(()=>[p(v(s.value?"登录":"注册"),1)]),_:1},8,["loading"])]),_:1}),a(n,null,{default:o(()=>[a(w,{type:"text",onClick:L,style:{width:"100%"}},{default:o(()=>[p(v(s.value?"没有账号？去注册":"已有账号？去登录"),1)]),_:1})]),_:1}),a(D,null,{default:o(()=>[...l[4]||(l[4]=[p("或",-1)])]),_:1}),a(n,null,{default:o(()=>[a(w,{onClick:P,style:{width:"100%"},loading:g.value},{default:o(()=>[...l[5]||(l[5]=[h("span",{style:{"margin-right":"8px"}},"🐧",-1),p(" 使用 Linux.Do 账号登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}}),Z=W(H,[["__scopeId","data-v-32cd3342"]]);export{Z as default};

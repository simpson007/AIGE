/* empty css                *//* empty css                 */import{K as hl,L as x,d as Je,r as c,a as me,z as ce,q as We,c as _,n as s,b as e,k as Qe,w as l,l as f,f as dl,i as il,M as rl,F as Y,B as Z,g as le,h as N,t as k,N as ul,m as cl,O as kl,v as ml,x as p,P as Cl,Q as qe,R as Vl,S as $l,T as ll,U as He,j as Xe,V as pl,W as vl,X as _l,Y as xl,C as fl,p as g,Z as Ee,_ as Pl,$ as gl,o as r,a0 as yl,J as Ml,u as Al,e as Ul,a1 as Il,a2 as Sl,a3 as El,a4 as zl,a5 as Tl,a6 as al,a7 as tl,a8 as sl,a9 as Se,aa as je,ab as Dl,ac as Ol,ad as Ll,ae as Rl,af as Gl,ag as Fe,ah as Bl,ai as Nl,aj as jl,ak as ol,al as Fl,am as ql,an as Hl,E as Kl,G as nl,ao as Jl,ap as Wl,aq as Ql,ar as Xl}from"./index-mlxIPnk9.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{k as Yl}from"./marked.esm-z4go5P_g.js";const Ze=hl("admin",()=>({getUsers:async()=>(await x.get("/admin/users")).users,getUser:async n=>await x.get(`/admin/users/${n}`),updateUserPassword:async(n,m)=>{await x.put(`/admin/users/${n}/password`,{new_password:m})},deleteUser:async n=>{await x.delete(`/admin/users/${n}`)},toggleUserAdmin:async n=>{await x.put(`/admin/users/${n}/toggle-admin`)},getProviders:async()=>(await x.get("/admin/providers")).providers,getProvider:async n=>await x.get(`/admin/providers/${n}`),createProvider:async n=>await x.post("/admin/providers",n),updateProvider:async(n,m)=>await x.put(`/admin/providers/${n}`,m),deleteProvider:async n=>{await x.delete(`/admin/providers/${n}`)},toggleProvider:async n=>await x.put(`/admin/providers/${n}/toggle`),getAvailableModels:async(n,m)=>{const O=m?`/admin/providers/${n}/models/available?api_type=${m}`:`/admin/providers/${n}/models/available`;return(await x.get(O)).models},testConnection:async(n,m)=>{const O=m?`/admin/providers/${n}/test?model_id=${m}`:`/admin/providers/${n}/test`;return await x.get(O)},getModels:async n=>{const m=n?`/admin/models?provider_id=${n}`:"/admin/models";return(await x.get(m)).models},getModel:async n=>await x.get(`/admin/models/${n}`),createModel:async n=>await x.post("/admin/models",n),updateModel:async(n,m)=>await x.put(`/admin/models/${n}`,m),deleteModel:async n=>{await x.delete(`/admin/models/${n}`)},toggleModel:async n=>await x.put(`/admin/models/${n}/toggle`),testModel:async n=>await x.post(`/admin/models/${n}/test`),updateModelCapabilities:async(n,m)=>await x.put(`/admin/models/${n}/capabilities`,{capabilities:m}),getOAuthConfig:async()=>await x.get("/admin/oauth/config"),saveOAuthConfig:async n=>{await x.post("/admin/oauth/config",n)}})),Zl={class:"provider-management"},ea={class:"game-ai-config",style:{"margin-bottom":"24px"}},la={class:"config-header"},aa={class:"config-content"},ta={class:"default-model-selectors"},sa={class:"game-model-list"},oa={class:"game-info"},na={class:"game-name"},da={class:"model-selectors"},ia={key:0,class:"no-games"},ra={style:{"margin-bottom":"24px"}},ua={class:"page-header"},ca={key:0,class:"empty-state"},ma={key:1,class:"providers-list"},pa={class:"provider-header"},va={class:"provider-title"},_a={style:{margin:"0 8px","font-size":"16px","font-weight":"500"}},fa={class:"provider-actions"},ga={class:"provider-fields"},ya={class:"field-item"},ba={class:"field-item"},wa={class:"field-label"},ha={key:0,style:{"font-size":"12px",color:"#909399"}},ka={class:"models-header"},Ca={class:"field-label"},Va={class:"models-list"},$a={key:0,class:"models-empty"},xa={class:"model-info"},Pa={class:"model-name"},Ma={class:"model-actions"},Aa={class:"provider-types"},Ua=["onClick"],Ia={key:0,style:{"margin-left":"12px",color:"#67c23a"}},Sa={class:"model-select-list"},Ea=["onClick"],za={key:0,class:"model-select-empty"},Ta=Je({__name:"ProviderManagement",setup(he){const P=Ze(),L=c([]),H=c(!1),M=c(!1),V=c(!1),z=c(!1),C=c(!1),I=c(null),S=c(null),w=c(null),K=c(!1),A=c([]),W=c(""),j=c(""),ae=c(null),D=c([]),y=me({defaultModelId:"",gameModels:{}}),R=c(!1),te=c(null),ee=c(""),se=me({}),h=me({}),n=ce(()=>L.value.filter(t=>t.enabled)),m=ce(()=>{const t=[];for(const a of L.value)if(a.models)for(const u of a.models)u.enabled&&a.enabled&&t.push({...u,provider:a});return t}),O=ce(()=>te.value?m.value.filter(t=>t.provider_id===te.value):[]),ne=t=>{const a=se[t];return a?m.value.filter(u=>u.provider_id===a):[]},$=c({type:"openai",name:"",api_key:"",base_url:""}),T=c({model_id:"",name:"",api_type:"openai",provider_id:0}),U=[{value:"openai",label:"OpenAI",description:"GPT-4, GPT-3.5等模型"},{value:"anthropic",label:"Anthropic",description:"Claude系列模型"},{value:"google",label:"Google",description:"Gemini系列模型"},{value:"custom",label:"自定义",description:"兼容OpenAI格式的API"}],pe=ce(()=>{if(!W.value.trim())return A.value;const t=W.value.toLowerCase().trim().split(/\s+/);return A.value.filter(a=>{const u=a.toLowerCase();return t.every(i=>u.includes(i))})}),ve=t=>({openai:"OpenAI",anthropic:"Anthropic",google:"Google",custom:"自定义"})[t]||t,ke=t=>({openai:"success",anthropic:"",google:"warning",custom:"info"})[t]||"info",ye=t=>({openai:"https://api.openai.com/v1/chat/completions",anthropic:"https://api.anthropic.com/v1/messages",google:"https://generativelanguage.googleapis.com/v1beta",custom:"https://api.example.com/v1"})[t]||"",Ce=t=>({openai:"OpenAI",anthropic:"Claude",google:"Gemini"})[t]||t,ze=t=>({openai:"success",anthropic:"",google:"warning"})[t]||"info",v=async()=>{H.value=!0;try{L.value=await P.getProviders()}catch(t){g.error(t.message||"加载提供商失败")}finally{H.value=!1}},o=t=>{M.value=!1,$.value={type:t,name:ve(t),api_key:"",base_url:""},V.value=!0},b=t=>{I.value=t,$.value={type:t.type,name:t.name,api_key:t.api_key,base_url:t.base_url||""},V.value=!0},Q=async t=>{try{await P.toggleProvider(t.id)}catch(a){t.enabled=!t.enabled,g.error(a.message||"操作失败")}},be=async(t,a,u)=>{const i={api_key:a==="api_key"?u:t.api_key,base_url:a==="base_url"?u:t.base_url};try{await P.updateProvider(t.id,i),a==="api_key"?t.api_key=u:t.base_url=u}catch(B){g.error(B.message||"更新失败")}},Te=async t=>{try{await Ee.confirm(`确定要删除提供商 "${t.name}" 吗？这将同时删除其所有模型配置。`,"确认删除",{type:"warning"}),await P.deleteProvider(t.id),g.success("删除成功"),await v()}catch(a){a!=="cancel"&&g.error(a.message||"删除失败")}},J=async()=>{if(!$.value.name||!$.value.api_key){g.warning("请填写必填项");return}C.value=!0;try{I.value?(await P.updateProvider(I.value.id,$.value),g.success("更新成功")):(await P.createProvider($.value),g.success("添加成功")),V.value=!1,I.value=null,await v()}catch(t){g.error(t.message||"保存失败")}finally{C.value=!1}},Ve=t=>{w.value=t,S.value=null,T.value={model_id:"",name:"",api_type:t.type==="custom"?"openai":t.type,provider_id:t.id},A.value=[],W.value="",j.value="",z.value=!0},De=(t,a)=>{w.value=t,S.value=a,T.value={model_id:a.model_id,name:a.name,api_type:a.api_type||t.type,provider_id:t.id},A.value=[],W.value="",j.value="",z.value=!0},_e=async t=>{try{await P.toggleModel(t.id)}catch(a){t.enabled=!t.enabled,g.error(a.message||"操作失败")}},$e=async(t,a)=>{try{await Ee.confirm(`确定要删除模型 "${a.name}" 吗？`,"确认删除",{type:"warning"}),await P.deleteModel(a.id),g.success("删除成功"),await v()}catch(u){u!=="cancel"&&g.error(u.message||"删除失败")}},xe=async(t,a)=>{ae.value=a.id;try{const{AIService:u}=await Pl(async()=>{const{AIService:B}=await Promise.resolve().then(()=>Oa);return{AIService:B}},void 0),i=await u.testConnection({provider_id:t.id,model_id:a.model_id,api_type:a.api_type||t.type});i.success?g.success(`模型 "${a.name}" 连接测试成功`):g.error(`测试失败: ${i.message}`)}catch(u){g.error(`测试失败: ${u.message}`)}finally{ae.value=null}},Oe=()=>{A.value=[],j.value=""},de=async()=>{if(w.value){K.value=!0,j.value="";try{const t=await P.getAvailableModels(w.value.id,T.value.api_type);A.value=t,t.length===0?j.value="未找到可用模型":g.success(`获取到 ${t.length} 个模型`)}catch(t){j.value=t.message||"获取模型列表失败，请检查API密钥和URL配置"}finally{K.value=!1}}},fe=t=>{T.value.model_id=t,T.value.name=t},Le=async()=>{if(!T.value.model_id||!T.value.name){g.warning("请填写模型ID和名称");return}C.value=!0;try{S.value?(await P.updateModel(S.value.id,T.value),g.success("更新成功")):(await P.createModel(T.value),g.success("添加成功")),re(),await v()}catch(t){g.error(t.message||"保存失败")}finally{C.value=!1}},re=()=>{z.value=!1,S.value=null,w.value=null,A.value=[],W.value="",j.value=""},Pe=async()=>{try{const t=await fetch("/api/game/mods",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){D.value=await t.json();for(const a of D.value)a.game_id in y.gameModels||(y.gameModels[a.game_id]="")}}catch(t){console.error("加载游戏列表失败:",t)}},Re=async()=>{try{const t=await fetch("/api/admin/game/model-config",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){const a=await t.json();y.defaultModelId=String(a.default_model_id||"");const u={};if(a.game_models)for(const[i,B]of Object.entries(a.game_models))u[i]=String(B||"");y.gameModels=u,console.log("游戏配置加载完成"),Ie()}}catch(t){console.error("加载游戏配置失败:",t)}},Me=async()=>{R.value=!0;try{const t=await fetch("/api/admin/game/model-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({default_model_id:y.defaultModelId,game_models:y.gameModels})});if(t.ok)g.success("游戏AI配置已保存");else{const a=await t.json();g.error(a.error||"保存失败")}}catch(t){g.error(t.message||"保存失败")}finally{R.value=!1}},F=()=>{ee.value="",ge()},Ae=()=>{ge()},X=t=>{h[t]="",Ue(t)},Ge=t=>{Ue(t)},ge=()=>{if(ee.value){const t=O.value.find(a=>a.model_id===ee.value);y.defaultModelId=t?String(t.id):""}else y.defaultModelId=""},Ue=t=>{if(h[t]){const u=ne(t).find(i=>i.model_id===h[t]);y.gameModels[t]=u?String(u.id):""}else y.gameModels[t]=""},Ie=()=>{if(y.defaultModelId){const t=m.value.find(a=>String(a.id)===y.defaultModelId);t&&(te.value=t.provider_id,ee.value=t.model_id)}for(const[t,a]of Object.entries(y.gameModels))if(a){const u=m.value.find(i=>String(i.id)===a);u&&(se[t]=u.provider_id,h[t]=u.model_id)}};return We(async()=>{await v(),await Re(),await Pe()}),(t,a)=>{const u=Qe,i=vl,B=rl,G=il,oe=ul,Be=dl,bl=cl,ie=ml,el=Vl,ue=Xe,Ne=pl,wl=gl;return r(),_("div",Zl,[s("div",ea,[s("div",la,[a[15]||(a[15]=s("h3",null,"🎮 游戏AI配置",-1)),e(u,{type:"success",size:"small",onClick:Me,loading:R.value},{default:l(()=>[...a[14]||(a[14]=[f(" 保存配置 ",-1)])]),_:1},8,["loading"])]),s("div",aa,[e(Be,{"label-width":"120px"},{default:l(()=>[e(G,{label:"默认模型"},{default:l(()=>[s("div",ta,[e(B,{modelValue:te.value,"onUpdate:modelValue":a[0]||(a[0]=d=>te.value=d),placeholder:"选择提供商",onChange:F,size:"small",style:{width:"150px"}},{default:l(()=>[(r(!0),_(Y,null,Z(n.value,d=>(r(),le(i,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(B,{modelValue:ee.value,"onUpdate:modelValue":a[1]||(a[1]=d=>ee.value=d),placeholder:"选择模型",disabled:!te.value,onChange:Ae,size:"small",style:{width:"200px"}},{default:l(()=>[(r(!0),_(Y,null,Z(O.value,d=>(r(),le(i,{key:d.id,label:d.name,value:d.model_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])])]),_:1}),e(G,{label:"游戏专用模型"},{default:l(()=>[s("div",sa,[(r(!0),_(Y,null,Z(D.value,d=>(r(),_("div",{key:d.game_id,class:"game-model-item"},[s("div",oa,[s("span",na,k(d.name),1),e(oe,{size:"small",type:"info"},{default:l(()=>[f(k(d.game_id),1)]),_:2},1024)]),s("div",da,[e(B,{modelValue:se[d.game_id],"onUpdate:modelValue":q=>se[d.game_id]=q,placeholder:"选择提供商",onChange:()=>X(d.game_id),size:"small",style:{width:"150px"}},{default:l(()=>[(r(!0),_(Y,null,Z(n.value,q=>(r(),le(i,{key:q.id,label:q.name,value:q.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"]),e(B,{modelValue:h[d.game_id],"onUpdate:modelValue":q=>h[d.game_id]=q,placeholder:"选择模型",disabled:!se[d.game_id],onChange:()=>Ge(d.game_id),size:"small",style:{width:"200px"}},{default:l(()=>[(r(!0),_(Y,null,Z(ne(d.game_id),q=>(r(),le(i,{key:q.id,label:q.name,value:q.model_id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])])]))),128)),!D.value||D.value.length===0?(r(),_("div",ia," 暂无可用游戏 ")):N("",!0)])]),_:1})]),_:1})])]),e(bl),s("div",ra,[s("div",ua,[a[17]||(a[17]=s("h3",null,"AI服务提供商",-1)),e(u,{type:"primary",onClick:a[2]||(a[2]=d=>M.value=!0)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(Cl))]),_:1}),a[16]||(a[16]=s("span",null,"添加提供商",-1))]),_:1})]),a[24]||(a[24]=kl('<div class="info-box" data-v-a6d4de80><h4 class="info-title" data-v-a6d4de80>API配置说明</h4><div class="info-content" data-v-a6d4de80><div data-v-a6d4de80><strong data-v-a6d4de80>OpenAI及兼容服务：</strong>API URL填写完整路径，如 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://api.openai.com/v1/chat/completions</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>Anthropic Claude：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://api.anthropic.com/v1/messages</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>Google Gemini：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://generativelanguage.googleapis.com/v1beta</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>自定义提供商：</strong>大多数第三方服务使用OpenAI兼容格式</div></div></div>',1)),L.value.length===0?(r(),_("div",ca,[e(ie,{style:{"font-size":"60px",color:"#dcdfe6","margin-bottom":"16px"}},{default:l(()=>[e(p(qe))]),_:1}),a[18]||(a[18]=s("p",null,"还没有配置任何AI提供商",-1)),a[19]||(a[19]=s("p",{style:{"font-size":"14px","margin-top":"8px",color:"#909399"}},"点击上方按钮添加您的第一个AI服务",-1))])):(r(),_("div",ma,[(r(!0),_(Y,null,Z(L.value,d=>{var q;return r(),_("div",{key:d.id,class:"provider-card"},[s("div",pa,[s("div",va,[e(el,{modelValue:d.enabled,"onUpdate:modelValue":E=>d.enabled=E,onChange:E=>Q(d)},null,8,["modelValue","onUpdate:modelValue","onChange"]),s("h4",_a,k(d.name),1),e(oe,{size:"small",type:ke(d.type)},{default:l(()=>[f(k(ve(d.type)),1)]),_:2},1032,["type"]),d.enabled&&d.api_key?(r(),le(ie,{key:0,style:{color:"#67c23a"},title:"已配置"},{default:l(()=>[e(p($l))]),_:1})):N("",!0)]),s("div",fa,[e(u,{size:"small",onClick:E=>b(d),title:"编辑提供商"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(ll))]),_:1})]),_:1},8,["onClick"]),e(u,{size:"small",type:"danger",onClick:E=>Te(d),title:"删除提供商"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick"])])]),s("div",ga,[s("div",ya,[a[20]||(a[20]=s("label",{class:"field-label"},"API密钥",-1)),e(ue,{"model-value":d.api_key,type:"password","show-password":"",placeholder:"输入API密钥","onUpdate:modelValue":E=>be(d,"api_key",E)},null,8,["model-value","onUpdate:modelValue"])]),s("div",ba,[s("label",wa,[a[21]||(a[21]=f(" API URL ",-1)),d.type!=="custom"?(r(),_("span",ha,"(可选)")):N("",!0)]),e(ue,{"model-value":d.base_url,type:"url",placeholder:ye(d.type),"onUpdate:modelValue":E=>be(d,"base_url",E)},null,8,["model-value","placeholder","onUpdate:modelValue"])])]),s("div",null,[s("div",ka,[s("label",Ca,"可用模型 ("+k(((q=d.models)==null?void 0:q.length)||0)+")",1),e(u,{size:"small",type:"primary",link:"",onClick:E=>Ve(d)},{default:l(()=>[...a[22]||(a[22]=[f(" 添加模型 ",-1)])]),_:1},8,["onClick"])]),s("div",Va,[!d.models||d.models.length===0?(r(),_("div",$a," 暂无模型 ")):N("",!0),(r(!0),_(Y,null,Z(d.models,E=>(r(),_("div",{key:E.id,class:"model-item"},[s("div",xa,[e(el,{modelValue:E.enabled,"onUpdate:modelValue":we=>E.enabled=we,onChange:we=>_e(E)},null,8,["modelValue","onUpdate:modelValue","onChange"]),s("span",Pa,k(E.name),1),E.api_type?(r(),le(oe,{key:0,size:"small",type:ze(E.api_type)},{default:l(()=>[f(k(Ce(E.api_type)),1)]),_:2},1032,["type"])):N("",!0)]),s("div",Ma,[e(u,{size:"small",onClick:we=>xe(d,E),loading:E.id===ae.value},{default:l(()=>[...a[23]||(a[23]=[f(" 测试 ",-1)])]),_:1},8,["onClick","loading"]),e(u,{size:"small",onClick:we=>De(d,E)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(ll))]),_:1})]),_:1},8,["onClick"]),e(u,{size:"small",type:"danger",onClick:we=>$e(d,E)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick"])])]))),128))])])])}),128))]))]),e(Ne,{modelValue:M.value,"onUpdate:modelValue":a[3]||(a[3]=d=>M.value=d),title:"选择提供商类型",width:"500px"},{default:l(()=>[s("div",Aa,[(r(),_(Y,null,Z(U,d=>s("div",{key:d.value,class:"provider-type-card",onClick:q=>o(d.value)},[s("h4",null,k(d.label),1),s("p",null,k(d.description),1)],8,Ua)),64))])]),_:1},8,["modelValue"]),e(Ne,{modelValue:V.value,"onUpdate:modelValue":a[8]||(a[8]=d=>V.value=d),title:I.value?"编辑提供商":"添加提供商",width:"500px"},{footer:l(()=>[e(u,{onClick:a[7]||(a[7]=d=>V.value=!1)},{default:l(()=>[...a[26]||(a[26]=[f("取消",-1)])]),_:1}),e(u,{type:"primary",loading:C.value,onClick:J},{default:l(()=>[f(k(I.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:l(()=>[e(Be,{model:$.value,"label-width":"100px"},{default:l(()=>[e(G,{label:"类型"},{default:l(()=>[e(oe,null,{default:l(()=>[f(k(ve($.value.type)),1)]),_:1})]),_:1}),e(G,{label:"名称",required:""},{default:l(()=>[e(ue,{modelValue:$.value.name,"onUpdate:modelValue":a[4]||(a[4]=d=>$.value.name=d),placeholder:"输入提供商名称"},null,8,["modelValue"])]),_:1}),e(G,{label:"API密钥",required:""},{default:l(()=>[e(ue,{modelValue:$.value.api_key,"onUpdate:modelValue":a[5]||(a[5]=d=>$.value.api_key=d),type:"password","show-password":"",placeholder:"输入API密钥"},null,8,["modelValue"])]),_:1}),e(G,{label:"API URL"},{default:l(()=>[e(ue,{modelValue:$.value.base_url,"onUpdate:modelValue":a[6]||(a[6]=d=>$.value.base_url=d),type:"url",placeholder:ye($.value.type)},null,8,["modelValue","placeholder"]),a[25]||(a[25]=s("div",{style:{"font-size":"12px",color:"#909399","margin-top":"4px"}},"留空使用默认地址",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(Ne,{modelValue:z.value,"onUpdate:modelValue":a[13]||(a[13]=d=>z.value=d),title:S.value?"编辑模型":"添加模型",width:"600px"},{footer:l(()=>[e(u,{onClick:re},{default:l(()=>[...a[28]||(a[28]=[f("取消",-1)])]),_:1}),e(u,{type:"primary",loading:C.value,onClick:Le},{default:l(()=>[f(k(S.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:l(()=>[e(Be,{model:T.value,"label-width":"100px"},{default:l(()=>[e(G,{label:"API类型"},{default:l(()=>[e(B,{modelValue:T.value.api_type,"onUpdate:modelValue":a[9]||(a[9]=d=>T.value.api_type=d),placeholder:"选择API类型",onChange:Oe},{default:l(()=>[e(i,{label:"OpenAI",value:"openai"}),e(i,{label:"Anthropic",value:"anthropic"}),e(i,{label:"Google",value:"google"})]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"模型ID",required:""},{default:l(()=>[e(ue,{modelValue:T.value.model_id,"onUpdate:modelValue":a[10]||(a[10]=d=>T.value.model_id=d),placeholder:"如：gpt-4o"},null,8,["modelValue"])]),_:1}),e(G,{label:"显示名称",required:""},{default:l(()=>[e(ue,{modelValue:T.value.name,"onUpdate:modelValue":a[11]||(a[11]=d=>T.value.name=d),placeholder:"如：GPT-4o"},null,8,["modelValue"])]),_:1}),e(G,{label:""},{default:l(()=>[e(u,{onClick:de,loading:K.value,type:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(_l))]),_:1}),a[27]||(a[27]=f(" 获取模型列表 ",-1))]),_:1},8,["loading"]),A.value.length>0?(r(),_("span",Ia," 已获取 "+k(A.value.length)+" 个模型 ",1)):N("",!0)]),_:1}),A.value.length>0?(r(),le(G,{key:0,label:"搜索过滤"},{default:l(()=>[e(ue,{modelValue:W.value,"onUpdate:modelValue":a[12]||(a[12]=d=>W.value=d),placeholder:"搜索模型（支持多关键词）",clearable:""},{prefix:l(()=>[e(ie,null,{default:l(()=>[e(p(xl))]),_:1})]),_:1},8,["modelValue"])]),_:1})):N("",!0),A.value.length>0?(r(),le(G,{key:1,label:"可用模型"},{default:l(()=>[s("div",Sa,[(r(!0),_(Y,null,Z(pe.value,d=>(r(),_("div",{key:d,class:fl(["model-select-item",{selected:T.value.model_id===d}]),onClick:q=>fe(d)},k(d),11,Ea))),128)),pe.value.length===0?(r(),_("div",za," 没有匹配的模型 ")):N("",!0)])]),_:1})):N("",!0),j.value?(r(),le(wl,{key:2,type:"error",title:j.value,closable:!1,style:{"margin-bottom":"16px"}},null,8,["title"])):N("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Da=Ye(Ta,[["__scopeId","data-v-a6d4de80"]]);class Ke{static async chat(P){return await x.post("/admin/ai/chat",P)}static async chatStream(P,L,H,M){var V;try{const z=localStorage.getItem("token"),C=await fetch("/api/admin/ai/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${z}`},body:JSON.stringify({...P,stream:!0})});if(!C.ok){const A=await C.text();throw new Error(`HTTP ${C.status}: ${A}`)}const I=(V=C.body)==null?void 0:V.getReader();if(!I)throw new Error("无法获取响应流");const S=new TextDecoder;let w="",K=0;for(;;){const{done:A,value:W}=await I.read();if(A){M();break}const j=S.decode(W,{stream:!0});w+=j;const ae=w.split(`
`);w=ae.pop()||"";for(const D of ae)if(D.trim()&&!D.startsWith("event:")&&D.startsWith("data:")){const y=D.slice(5).trim();if(!y)continue;try{const R=JSON.parse(y);if(R.content!==void 0&&R.content!==""&&(K++,L(R.content)),R.done){M();return}}catch(R){console.error("[AIService] 解析SSE数据失败:",R,y)}}}}catch(z){console.error("[AIService] chatStream错误:",z),H(z)}}static async testConnection(P){return await x.post("/admin/ai/test",P)}}const Oa=Object.freeze(Object.defineProperty({__proto__:null,AIService:Ke},Symbol.toStringTag,{value:"Module"})),La={class:"playground"},Ra={class:"playground-container"},Ga={class:"chat-panel"},Ba={class:"config-bar"},Na={style:{display:"flex","align-items":"center",gap:"8px"}},ja={class:"message-role"},Fa=["innerHTML"],qa={key:0,class:"message message-assistant"},Ha={class:"input-container"},Ka={class:"input-actions"},Ja=Je({__name:"Playground",setup(he){const P=Ze(),L=c([]),H=c([]),M=c(null),V=c(""),z=c(!0),C=c([]),I=c(""),S=c(!1),w=c(!1),K=c(),A=ce(()=>L.value.filter(h=>h.enabled)),W=ce(()=>M.value?H.value.filter(h=>h.provider_id===M.value&&h.enabled):[]),j=h=>{try{const n=Yl(h,{breaks:!0,gfm:!0});return typeof n=="string"?n:String(n)}catch{return h.replace(/\n/g,"<br>")}},ae=()=>{V.value="",y()},D=async()=>{try{L.value=await P.getProviders()}catch(h){g.error("加载提供商失败: "+h.message)}},y=async()=>{if(M.value)try{H.value=await P.getModels(M.value)}catch(h){g.error("加载模型失败: "+h.message)}},R=()=>{Ml(()=>{K.value&&(K.value.scrollTop=K.value.scrollHeight)})},te=h=>{h.ctrlKey&&h.key==="Enter"&&(h.preventDefault(),ee())},ee=async()=>{if(!I.value.trim()||!V.value||!M.value)return;const h={role:"user",content:I.value.trim()};C.value.push(h),I.value="",R();try{if(z.value){w.value=!0,R();let n="",m=-1;await Ke.chatStream({provider_id:M.value,model_id:V.value,messages:C.value,stream:!0},O=>{m===-1&&(w.value=!1,C.value.push({role:"assistant",content:""}),m=C.value.length-1),n+=O,C.value[m].content=n,R()},O=>{console.error("[Playground] onError 被调用:",O),w.value=!1,S.value=!1,g.error("对话失败: "+O.message)},()=>{w.value=!1,S.value=!1,R()})}else{S.value=!0;const n=await Ke.chat({provider_id:M.value,model_id:V.value,messages:C.value,stream:!1});C.value.push({role:"assistant",content:n.content}),S.value=!1,R()}}catch(n){S.value=!1,w.value=!1,g.error("发送消息失败: "+n.message)}},se=()=>{C.value=[]};return We(()=>{D()}),(h,n)=>{const m=vl,O=rl,ne=yl,$=Qe,T=Xe;return r(),_("div",La,[n[10]||(n[10]=s("div",{class:"playground-header"},[s("h2",null,"AI 操练场"),s("p",{class:"header-desc"},"选择提供商和模型进行对话测试")],-1)),s("div",Ra,[s("div",Ga,[s("div",Ba,[e(O,{modelValue:M.value,"onUpdate:modelValue":n[0]||(n[0]=U=>M.value=U),placeholder:"选择提供商",onChange:ae,style:{width:"200px"},size:"small"},{default:l(()=>[(r(!0),_(Y,null,Z(A.value,U=>(r(),le(m,{key:U.id,label:U.name,value:U.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(O,{modelValue:V.value,"onUpdate:modelValue":n[1]||(n[1]=U=>V.value=U),placeholder:"选择模型",disabled:!M.value,style:{width:"250px"},size:"small"},{default:l(()=>[(r(!0),_(Y,null,Z(W.value,U=>(r(),le(m,{key:U.id,label:U.name,value:U.model_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),s("div",Na,[n[4]||(n[4]=s("span",{style:{"font-size":"14px",color:"#666"}},"流式输出",-1)),e(ne,{modelValue:z.value,"onUpdate:modelValue":n[2]||(n[2]=U=>z.value=U),size:"small"},null,8,["modelValue"])]),n[6]||(n[6]=s("div",{style:{flex:"1"}},null,-1)),e($,{size:"small",onClick:se,disabled:C.value.length===0},{default:l(()=>[...n[5]||(n[5]=[f(" 清空对话 ",-1)])]),_:1},8,["disabled"])]),s("div",{class:"messages-container",ref_key:"messagesContainer",ref:K},[(r(!0),_(Y,null,Z(C.value,(U,pe)=>(r(),_("div",{key:pe,class:fl(["message",`message-${U.role}`])},[s("div",ja,k(U.role==="user"?"用户":"AI"),1),s("div",{class:"message-content",innerHTML:j(U.content)},null,8,Fa)],2))),128)),w.value?(r(),_("div",qa,[...n[7]||(n[7]=[s("div",{class:"message-role"},"AI",-1),s("div",{class:"message-content typing-indicator"},[s("span"),s("span"),s("span")],-1)])])):N("",!0)],512),s("div",Ha,[e(T,{modelValue:I.value,"onUpdate:modelValue":n[3]||(n[3]=U=>I.value=U),type:"textarea",rows:3,placeholder:"输入消息... (Ctrl+Enter 发送)",onKeydown:te,disabled:S.value||!V.value},null,8,["modelValue","disabled"]),s("div",Ka,[n[9]||(n[9]=s("span",{class:"input-hint"},"Ctrl + Enter 发送",-1)),e($,{type:"primary",onClick:ee,loading:S.value,disabled:!I.value.trim()||!V.value},{default:l(()=>[...n[8]||(n[8]=[f(" 发送 ",-1)])]),_:1},8,["loading","disabled"])])])])])])}}}),Wa=Ye(Ja,[["__scopeId","data-v-362b6de1"]]),Qa={class:"admin-container"},Xa={class:"header-content"},Ya={class:"mobile-menu-btn"},Za={class:"breadcrumb"},et={class:"mobile-title"},lt={class:"user-info"},at={class:"el-dropdown-link"},tt={key:0,class:"overview-content"},st={class:"stats-item"},ot={class:"stats-number"},nt={class:"stats-item"},dt={class:"stats-number"},it={class:"stats-item"},rt={class:"stats-number"},ut={key:1},ct={class:"card-header"},mt={class:"table-container pc-table"},pt={class:"action-buttons"},vt={class:"mobile-user-list"},_t={class:"user-info"},ft={class:"user-header"},gt={class:"username"},yt={class:"user-detail"},bt={class:"detail-item"},wt={class:"detail-value"},ht={class:"detail-item"},kt={class:"detail-value"},Ct={class:"user-actions"},Vt={key:2},$t={key:3},xt={key:4},Pt={class:"card-header"},Mt={style:{"margin-left":"10px",color:"#909399"}},At={key:5},Ut={class:"mobile-sidebar"},It={class:"dialog-footer"},St=Je({__name:"AdminView",setup(he){const P=Ul(),L=Al(),H=Ze(),M=c(!1),V=c([]),z=c(!1),C=c(!1),I=c(null),S=c(),w=c("overview"),K=c(!1),A=c(!1),W=ce(()=>V.value.length),j=ce(()=>V.value.filter(v=>v.is_admin).length),ae=c(0),D=me({siteName:"AI Game Engine",siteDescription:"一个基于AI的文字冒险游戏引擎",allowRegister:!0}),y=me({newPassword:"",confirmPassword:""}),te=me({newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(v,o,b)=>{o!==y.newPassword?b(new Error("两次输入密码不一致")):b()},trigger:"blur"}]});We(()=>{if(!L.isAdmin()){P.push("/chat");return}$(),m()});const ee=v=>{w.value=v,v==="users"?$():v==="oauth"&&m()},se=()=>{A.value=!A.value},h=v=>{w.value=v,A.value=!1,v==="users"?$():v==="oauth"&&m()},n=me({client_id:"",client_secret:"",redirect_url:`${window.location.origin}/auth/callback/linux-do`,auth_url:"https://connect.linux.do/oauth2/authorize",token_url:"https://connect.linux.do/oauth2/token",user_info_url:"https://connect.linux.do/api/user",enabled:!1}),m=async()=>{try{const v=await H.getOAuthConfig();Object.assign(n,v)}catch(v){console.error("加载 OAuth 配置失败:",v)}},O=async()=>{try{K.value=!0,await H.saveOAuthConfig(n),g.success("OAuth 配置保存成功")}catch(v){console.error("保存 OAuth 配置失败:",v)}finally{K.value=!1}},ne=()=>({overview:"概览",users:"用户管理",providers:"提供商管理",playground:"操练场",oauth:"OAuth配置",system:"系统设置"})[w.value]||"概览",$=async()=>{M.value=!0;try{V.value=await H.getUsers()}catch(v){console.error("获取用户列表失败:",v)}finally{M.value=!1}},T=()=>{$()},U=v=>{I.value=v,y.newPassword="",y.confirmPassword="",z.value=!0},pe=async()=>{if(!(!S.value||!I.value))try{if(!await S.value.validate())return;C.value=!0,await H.updateUserPassword(I.value.id,y.newPassword),g.success("密码修改成功"),z.value=!1}catch(v){console.error("密码修改失败:",v)}finally{C.value=!1}},ve=async v=>{try{await Ee.confirm(`确定要${v.is_admin?"取消":"设置"}用户 "${v.username}" 的管理员权限吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await H.toggleUserAdmin(v.id),g.success("权限修改成功"),await $()}catch(o){o!=="cancel"&&console.error("权限修改失败:",o)}},ke=async v=>{try{await Ee.confirm(`确定要删除用户 "${v.username}" 吗？此操作不可恢复！`,"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await H.deleteUser(v.id),g.success("用户删除成功"),await $()}catch(o){o!=="cancel"&&console.error("用户删除失败:",o)}},ye=()=>{L.logout()},Ce=()=>{P.push("/chat")},ze=()=>{g.success("系统设置已保存")};return(v,o)=>{const b=ml,Q=Tl,be=zl,Te=El,J=Qe,Ve=Rl,De=Ll,_e=jl,$e=Nl,xe=Gl,Oe=Dl,de=Kl,fe=Hl,Le=ql,re=Wl,Pe=ul,Re=Xl,Me=yl,F=il,Ae=cl,X=Xe,Ge=gl,ge=dl,Ue=Fl,Ie=Il,t=Sl,a=pl,u=Jl;return r(),_("div",Qa,[e(Ie,{style:{height:"100vh"}},{default:l(()=>[e(Te,{width:"250px",class:"admin-sidebar pc-sidebar"},{default:l(()=>[e(be,{"default-active":w.value,class:"admin-menu","background-color":"#001529","text-color":"#ffffff","active-text-color":"#1890ff",onSelect:ee},{default:l(()=>[e(Q,{index:"overview"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(al))]),_:1}),o[15]||(o[15]=s("span",null,"概览",-1))]),_:1}),e(Q,{index:"users"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(tl))]),_:1}),o[16]||(o[16]=s("span",null,"用户管理",-1))]),_:1}),e(Q,{index:"providers"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(sl))]),_:1}),o[17]||(o[17]=s("span",null,"提供商管理",-1))]),_:1}),e(Q,{index:"playground"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[18]||(o[18]=s("span",null,"操练场",-1))]),_:1}),e(Q,{index:"oauth"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1}),o[19]||(o[19]=s("span",null,"OAuth配置",-1))]),_:1}),e(Q,{index:"system"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(qe))]),_:1}),o[20]||(o[20]=s("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),e(Ie,null,{default:l(()=>[e(Oe,{class:"admin-header"},{default:l(()=>[s("div",Xa,[s("div",Ya,[e(J,{type:"text",onClick:se,class:"menu-toggle",size:"large"},{default:l(()=>[e(b,{size:"20"},{default:l(()=>[e(p(Ol))]),_:1})]),_:1})]),s("div",Za,[e(De,{separator:"/",class:"pc-breadcrumb"},{default:l(()=>[e(Ve,null,{default:l(()=>[...o[21]||(o[21]=[f("管理后台",-1)])]),_:1}),e(Ve,null,{default:l(()=>[f(k(ne()),1)]),_:1})]),_:1}),s("h3",et,k(ne()),1)]),s("div",lt,[e(xe,{class:"pc-user-dropdown"},{dropdown:l(()=>[e($e,null,{default:l(()=>[e(_e,{onClick:Ce},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[22]||(o[22]=f(" 返回主页 ",-1))]),_:1}),e(_e,{divided:"",onClick:ye},{default:l(()=>[e(b,null,{default:l(()=>[e(p(ol))]),_:1}),o[23]||(o[23]=f(" 退出登录 ",-1))]),_:1})]),_:1})]),default:l(()=>{var i;return[s("span",at,[e(b,null,{default:l(()=>[e(p(Fe))]),_:1}),f(" "+k((i=p(L).user)==null?void 0:i.username)+" ",1),e(b,{class:"el-icon--right"},{default:l(()=>[e(p(Bl))]),_:1})])]}),_:1}),e(xe,{class:"mobile-user-dropdown"},{dropdown:l(()=>[e($e,null,{default:l(()=>[e(_e,{onClick:Ce},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[24]||(o[24]=f(" 返回主页 ",-1))]),_:1}),e(_e,{divided:"",onClick:ye},{default:l(()=>[e(b,null,{default:l(()=>[e(p(ol))]),_:1}),o[25]||(o[25]=f(" 退出登录 ",-1))]),_:1})]),_:1})]),default:l(()=>[e(J,{type:"text",size:"large"},{default:l(()=>[e(b,{size:"20"},{default:l(()=>[e(p(Fe))]),_:1})]),_:1})]),_:1})])])]),_:1}),e(Ue,{class:"admin-main"},{default:l(()=>[w.value==="overview"?(r(),_("div",tt,[e(Le,{gutter:20},{default:l(()=>[e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",st,[s("div",ot,k(W.value),1),o[26]||(o[26]=s("div",{class:"stats-label"},"总用户数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",nt,[s("div",dt,k(j.value),1),o[27]||(o[27]=s("div",{class:"stats-label"},"管理员数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",it,[s("div",rt,k(ae.value),1),o[28]||(o[28]=s("div",{class:"stats-label"},"对话总数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[...o[29]||(o[29]=[s("div",{class:"stats-item"},[s("div",{class:"stats-number"},"Online"),s("div",{class:"stats-label"},"系统状态")],-1)])]),_:1})]),_:1})]),_:1})])):N("",!0),w.value==="users"?(r(),_("div",ut,[e(de,null,{header:l(()=>[s("div",ct,[o[31]||(o[31]=s("span",null,"用户管理",-1)),e(J,{type:"primary",onClick:T},{default:l(()=>[e(b,null,{default:l(()=>[e(p(_l))]),_:1}),o[30]||(o[30]=f(" 刷新 ",-1))]),_:1})])]),default:l(()=>[s("div",mt,[nl((r(),le(Re,{data:V.value,style:{width:"100%"},class:"responsive-table"},{default:l(()=>[e(re,{prop:"id",label:"ID",width:"80"}),e(re,{prop:"username",label:"用户名","min-width":"120"}),e(re,{prop:"email",label:"邮箱","min-width":"180"}),e(re,{prop:"is_admin",label:"管理员",width:"100"},{default:l(i=>[e(Pe,{type:i.row.is_admin?"success":"info",size:"small"},{default:l(()=>[f(k(i.row.is_admin?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),e(re,{label:"操作","min-width":"200"},{default:l(i=>{var B,G;return[s("div",pt,[e(J,{size:"small",onClick:oe=>U(i.row)},{default:l(()=>[...o[32]||(o[32]=[f(" 密码 ",-1)])]),_:1},8,["onClick"]),e(J,{size:"small",type:"warning",onClick:oe=>ve(i.row),disabled:i.row.id===((B=p(L).user)==null?void 0:B.id)},{default:l(()=>[f(k(i.row.is_admin?"取消":"设置"),1)]),_:2},1032,["onClick","disabled"]),e(J,{size:"small",type:"danger",onClick:oe=>ke(i.row),disabled:i.row.id===((G=p(L).user)==null?void 0:G.id)},{default:l(()=>[...o[33]||(o[33]=[f(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])])]}),_:1})]),_:1},8,["data"])),[[u,M.value]])]),nl((r(),_("div",vt,[(r(!0),_(Y,null,Z(V.value,i=>{var B,G;return r(),_("div",{class:"mobile-user-card",key:i.id},[s("div",_t,[s("div",ft,[s("span",gt,k(i.username),1),e(Pe,{type:i.is_admin?"success":"info",size:"small"},{default:l(()=>[f(k(i.is_admin?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),s("div",yt,[s("div",bt,[o[34]||(o[34]=s("span",{class:"detail-label"},"ID:",-1)),s("span",wt,k(i.id),1)]),s("div",ht,[o[35]||(o[35]=s("span",{class:"detail-label"},"邮箱:",-1)),s("span",kt,k(i.email||"未设置"),1)])])]),s("div",Ct,[e(J,{size:"small",onClick:oe=>U(i),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1})]),_:1},8,["onClick"]),e(J,{size:"small",type:"warning",onClick:oe=>ve(i),disabled:i.id===((B=p(L).user)==null?void 0:B.id),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Fe))]),_:1})]),_:1},8,["onClick","disabled"]),e(J,{size:"small",type:"danger",onClick:oe=>ke(i),disabled:i.id===((G=p(L).user)==null?void 0:G.id),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick","disabled"])])])}),128))])),[[u,M.value]])]),_:1})])):N("",!0),w.value==="providers"?(r(),_("div",Vt,[e(Da)])):N("",!0),w.value==="playground"?(r(),_("div",$t,[e(Wa)])):N("",!0),w.value==="oauth"?(r(),_("div",xt,[e(de,null,{header:l(()=>[s("div",Pt,[o[37]||(o[37]=s("span",null,"Linux.Do OAuth 配置",-1)),e(J,{type:"primary",onClick:O,loading:K.value},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Ql))]),_:1}),o[36]||(o[36]=f(" 保存配置 ",-1))]),_:1},8,["loading"])])]),default:l(()=>[e(ge,{model:n,"label-width":"150px",class:"oauth-form"},{default:l(()=>[e(F,{label:"启用状态"},{default:l(()=>[e(Me,{modelValue:n.enabled,"onUpdate:modelValue":o[0]||(o[0]=i=>n.enabled=i)},null,8,["modelValue"]),s("span",Mt,k(n.enabled?"已启用":"已禁用"),1)]),_:1}),e(Ae),e(F,{label:"Client ID",required:""},{default:l(()=>[e(X,{modelValue:n.client_id,"onUpdate:modelValue":o[1]||(o[1]=i=>n.client_id=i),placeholder:"请输入 Linux.Do OAuth Client ID"},null,8,["modelValue"])]),_:1}),e(F,{label:"Client Secret",required:""},{default:l(()=>[e(X,{modelValue:n.client_secret,"onUpdate:modelValue":o[2]||(o[2]=i=>n.client_secret=i),placeholder:"请输入 Linux.Do OAuth Client Secret"},null,8,["modelValue"])]),_:1}),e(F,{label:"Redirect URL"},{default:l(()=>[e(X,{modelValue:n.redirect_url,"onUpdate:modelValue":o[3]||(o[3]=i=>n.redirect_url=i),placeholder:"http://localhost:3000/auth/callback/linux-do"},null,8,["modelValue"]),o[38]||(o[38]=s("div",{style:{color:"#909399","font-size":"12px","margin-top":"5px"}}," 需要在 Linux.Do OAuth 应用中配置此回调地址 ",-1))]),_:1}),e(Ae,null,{default:l(()=>[...o[39]||(o[39]=[f("高级配置",-1)])]),_:1}),e(F,{label:"Authorization URL"},{default:l(()=>[e(X,{modelValue:n.auth_url,"onUpdate:modelValue":o[4]||(o[4]=i=>n.auth_url=i),placeholder:"https://connect.linux.do/oauth2/authorize"},null,8,["modelValue"])]),_:1}),e(F,{label:"Token URL"},{default:l(()=>[e(X,{modelValue:n.token_url,"onUpdate:modelValue":o[5]||(o[5]=i=>n.token_url=i),placeholder:"https://connect.linux.do/oauth2/token"},null,8,["modelValue"])]),_:1}),e(F,{label:"User Info URL"},{default:l(()=>[e(X,{modelValue:n.user_info_url,"onUpdate:modelValue":o[6]||(o[6]=i=>n.user_info_url=i),placeholder:"https://connect.linux.do/api/user"},null,8,["modelValue"])]),_:1}),e(Ge,{title:"配置说明",type:"info",closable:!1,style:{"margin-top":"20px"}},{default:l(()=>[...o[40]||(o[40]=[s("p",null,"1. 前往 Linux.Do 开发者中心创建 OAuth 应用",-1),s("p",null,"2. 获取 Client ID 和 Client Secret",-1),s("p",null,"3. 配置回调地址为上方的 Redirect URL",-1),s("p",null,"4. 启用 OAuth 功能后，用户即可使用 Linux.Do 账号登录",-1)])]),_:1})]),_:1},8,["model"])]),_:1})])):N("",!0),w.value==="system"?(r(),_("div",At,[e(de,null,{header:l(()=>[...o[41]||(o[41]=[s("span",null,"系统设置",-1)])]),default:l(()=>[e(ge,{"label-width":"120px",class:"system-form"},{default:l(()=>[e(F,{label:"系统名称"},{default:l(()=>[e(X,{modelValue:D.siteName,"onUpdate:modelValue":o[7]||(o[7]=i=>D.siteName=i),placeholder:"AI Chat System"},null,8,["modelValue"])]),_:1}),e(F,{label:"系统描述"},{default:l(()=>[e(X,{type:"textarea",modelValue:D.siteDescription,"onUpdate:modelValue":o[8]||(o[8]=i=>D.siteDescription=i),placeholder:"一个基于AI的智能对话系统",rows:3},null,8,["modelValue"])]),_:1}),e(F,{label:"允许注册"},{default:l(()=>[e(Me,{modelValue:D.allowRegister,"onUpdate:modelValue":o[9]||(o[9]=i=>D.allowRegister=i)},null,8,["modelValue"])]),_:1}),e(F,{class:"form-actions"},{default:l(()=>[e(J,{type:"primary",onClick:ze,class:"save-btn"},{default:l(()=>[...o[42]||(o[42]=[f("保存设置",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):N("",!0)]),_:1})]),_:1})]),_:1}),e(t,{modelValue:A.value,"onUpdate:modelValue":o[10]||(o[10]=i=>A.value=i),direction:"ltr",size:"280px","with-header":!1,class:"mobile-menu-drawer"},{default:l(()=>[s("div",Ut,[e(be,{"default-active":w.value,class:"mobile-admin-menu","background-color":"#001529","text-color":"#ffffff","active-text-color":"#1890ff",onSelect:h},{default:l(()=>[e(Q,{index:"overview"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(al))]),_:1}),o[43]||(o[43]=s("span",null,"概览",-1))]),_:1}),e(Q,{index:"users"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(tl))]),_:1}),o[44]||(o[44]=s("span",null,"用户管理",-1))]),_:1}),e(Q,{index:"providers"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(sl))]),_:1}),o[45]||(o[45]=s("span",null,"提供商管理",-1))]),_:1}),e(Q,{index:"playground"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[46]||(o[46]=s("span",null,"操练场",-1))]),_:1}),e(Q,{index:"oauth"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1}),o[47]||(o[47]=s("span",null,"OAuth配置",-1))]),_:1}),e(Q,{index:"system"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(qe))]),_:1}),o[48]||(o[48]=s("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])])]),_:1},8,["modelValue"]),e(a,{modelValue:z.value,"onUpdate:modelValue":o[14]||(o[14]=i=>z.value=i),title:"修改用户密码",width:"400px"},{footer:l(()=>[s("div",It,[e(J,{onClick:o[13]||(o[13]=i=>z.value=!1)},{default:l(()=>[...o[49]||(o[49]=[f("取消",-1)])]),_:1}),e(J,{type:"primary",onClick:pe,loading:C.value},{default:l(()=>[...o[50]||(o[50]=[f(" 确认 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[e(ge,{model:y,rules:te,ref_key:"passwordFormRef",ref:S},{default:l(()=>[e(F,{label:"用户名"},{default:l(()=>{var i;return[e(X,{value:(i=I.value)==null?void 0:i.username,disabled:""},null,8,["value"])]}),_:1}),e(F,{label:"新密码",prop:"newPassword"},{default:l(()=>[e(X,{modelValue:y.newPassword,"onUpdate:modelValue":o[11]||(o[11]=i=>y.newPassword=i),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(F,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[e(X,{modelValue:y.confirmPassword,"onUpdate:modelValue":o[12]||(o[12]=i=>y.confirmPassword=i),type:"password",placeholder:"请确认新密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Lt=Ye(St,[["__scopeId","data-v-1936b840"]]);export{Lt as default};
